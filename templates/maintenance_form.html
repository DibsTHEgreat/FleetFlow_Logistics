{% extends "base.html" %}

{% block content %}
<h1>{{ "Edit Maintenance Log" if is_edit else "Add Maintenance Log" }}</h1>

{% if error %}
<div class="alert alert-danger">{{ error }}</div>
{% endif %}

<form method="post" action="{{ form_action }}">
    <div class="mb-3">
        <label for="vehicle_id" class="form-label">Vehicle</label>
        <select name="vehicle_id" id="vehicle_id" class="form-select" required>
            <option value="">-- Select vehicle --</option>
            {% for v in vehicles %}
                {% set selected = "" %}
                {% if log and log.vehicle_id == v.vehicle_id %}
                    {% set selected = "selected" %}
                {% endif %}
                <option value="{{ v.vehicle_id }}" {{ selected }}>
                    {{ v.vehicle_id }} ({{ v.type }})
                </option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-3">
        <label for="service_date" class="form-label">Service Date</label>
        <input
            type="date"
            name="service_date"
            id="service_date"
            class="form-control"
            required
            value="{{ log.service_date if log else '' }}"
        >
    </div>

    <div class="mb-3">
        <label for="service_type" class="form-label">Service Type</label>
        <input
            type="text"
            name="service_type"
            id="service_type"
            class="form-control"
            placeholder="Oil change, tire rotation, inspection..."
            required
            value="{{ log.service_type if log else '' }}"
        >
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea
            name="description"
            id="description"
            class="form-control"
            rows="3"
            required
        >{{ log.description if log else "" }}</textarea>
    </div>

    <div class="mb-3">
        <label for="odometer_at_service" class="form-label">Odometer at Service (km)</label>
        <input
            type="number"
            name="odometer_at_service"
            id="odometer_at_service"
            class="form-control"
            min="0"
            value="{{ log.odometer_at_service if log and log.odometer_at_service is not none else '' }}"
        >
    </div>

    <div class="mb-3">
        <label for="vendor" class="form-label">Vendor</label>
        <input
            type="text"
            name="vendor"
            id="vendor"
            class="form-control"
            value="{{ log.vendor if log else '' }}"
        >
    </div>

    <div class="mb-3">
        <label for="cost" class="form-label">Cost</label>
        <input
            type="number"
            step="0.01"
            min="0"
            name="cost"
            id="cost"
            class="form-control"
            value="{{ log.cost if log and log.cost is not none else '' }}"
        >
    </div>

    <button type="submit" class="btn btn-primary">
        {{ "Save Changes" if is_edit else "Create Maintenance Log" }}
    </button>
    <a href="{{ url_for('list_maintenance') }}" class="btn btn-secondary ms-2">Cancel</a>
</form>
{% endblock %}
